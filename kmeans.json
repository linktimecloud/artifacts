{"paragraphs":[{"text":"这个Zeppelin笔记主要是演示一个网络入侵的检测算法，这个预测算法使\n用K-means聚类方法来区别“坏的”（也就是网络入侵或者攻击），和“好的”\n（正常的）网络连接。演示的模拟数据来自美国的一个军方网络环境（DARPA），\n其中包括了各种模拟的网络入侵行为。","user":"songwenxin","dateUpdated":"2018-08-16T04:10:04+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":18,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1534392604222_-314734235","id":"20180802-174534_221510609","dateCreated":"2018-08-16T04:10:04+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3679"},{"title":"第一步：加载数据，把数据读到dataframe中","text":"val df = sqlContext.load(\"com.databricks.spark.csv\", Map(\"path\" -> \"file:///zeppelin/datasets/darpa.csv\", \"header\" -> \"true\"))","user":"songwenxin","dateUpdated":"2018-08-16T04:10:04+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one deprecation warning; re-run with -deprecation for details\ndf: org.apache.spark.sql.DataFrame = [duration: string, protocol_type: string ... 40 more fields]\n"}]},"apps":[],"jobName":"paragraph_1534392604222_1007153019","id":"20180802-131809_620305751","dateCreated":"2018-08-16T04:10:04+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3680"},{"title":"第二步：打印出数据结构，并根据网络标签（label）进行分组计数","text":"df.printSchema\ndf.groupBy($\"label\").count().orderBy($\"count\".desc).registerTempTable(\"networklabelcount\")","user":"songwenxin","dateUpdated":"2018-08-16T04:10:04+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one deprecation warning; re-run with -deprecation for details\nroot\n |-- duration: string (nullable = true)\n |-- protocol_type: string (nullable = true)\n |-- service: string (nullable = true)\n |-- flag: string (nullable = true)\n |-- src_bytes: string (nullable = true)\n |-- dst_bytes: string (nullable = true)\n |-- land: string (nullable = true)\n |-- wrong_fragment: string (nullable = true)\n |-- urgent: string (nullable = true)\n |-- hot: string (nullable = true)\n |-- num_failed_logins: string (nullable = true)\n |-- logged_in: string (nullable = true)\n |-- num_compromised: string (nullable = true)\n |-- root_shell: string (nullable = true)\n |-- su_attempted: string (nullable = true)\n |-- num_root: string (nullable = true)\n |-- num_file_creations: string (nullable = true)\n |-- num_shells: string (nullable = true)\n |-- num_access_files: string (nullable = true)\n |-- num_outbound_cmds: string (nullable = true)\n |-- is_host_login: string (nullable = true)\n |-- is_guest_login: string (nullable = true)\n |-- count: string (nullable = true)\n |-- srv_count: string (nullable = true)\n |-- serror_rate: string (nullable = true)\n |-- srv_serror_rate: string (nullable = true)\n |-- rerror_rate: string (nullable = true)\n |-- srv_rerror_rate: string (nullable = true)\n |-- same_srv_rate: string (nullable = true)\n |-- diff_srv_rate: string (nullable = true)\n |-- srv_diff_host_rate: string (nullable = true)\n |-- dst_host_count: string (nullable = true)\n |-- dst_host_srv_count: string (nullable = true)\n |-- dst_host_same_srv_rate: string (nullable = true)\n |-- dst_host_diff_srv_rate: string (nullable = true)\n |-- dst_host_same_src_port_rate: string (nullable = true)\n |-- dst_host_srv_diff_host_rate: string (nullable = true)\n |-- dst_host_serror_rate: string (nullable = true)\n |-- dst_host_srv_serror_rate: string (nullable = true)\n |-- dst_host_rerror_rate: string (nullable = true)\n |-- dst_host_srv_rerror_rate: string (nullable = true)\n |-- label: string (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1534392604223_-1637955366","id":"20180802-131828_1700481834","dateCreated":"2018-08-16T04:10:04+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3681"},{"title":"第三步：显示各种网络类型的数量","text":"%sql SELECT * FROM networklabelcount","user":"songwenxin","dateUpdated":"2018-08-16T04:10:04+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"label":"string","count":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"label","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"count","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"label\tcount\nsmurf.\t28150\nneptune.\t10721\nnormal.\t9837\nback.\t216\nsatan.\t168\nipsweep.\t125\nportsweep.\t120\nteardrop.\t100\nwarezclient.\t82\nnmap.\t26\npod.\t25\nguess_passwd.\t6\nland.\t4\nbuffer_overflow.\t3\nwarezmaster.\t2\nphf.\t2\nimap.\t2\nloadmodule.\t1\nmultihop.\t1\nrootkit.\t1\nspy.\t1\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1534392604223_-616594033","id":"20180802-131849_1903295799","dateCreated":"2018-08-16T04:10:04+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3682"},{"title":"第四步：开始运行K-means算法，按K=10，20，30，40，50，60运行6次，并计算出每次的得分（得分越低聚类效果越好）","text":"%spark\nval rawData = sc.textFile(\"file:///zeppelin/datasets/darpa.csv\")\nrawData.map(_.split(',').last).countByValue().toSeq.sortBy(_._2).reverse.foreach(println)\n\nimport org.apache.spark.mllib.linalg._\nval labelsAndData = rawData.zipWithIndex.flatMap {\n  case (line,index) =>\n    if (index == 0) {\n      None\n    } else {\n      val buffer = line.split(',').toBuffer\n      buffer.remove(1, 3)\n      val label = buffer.remove(buffer.length-1)\n      val vector = Vectors.dense(buffer.map(_.toDouble).toArray)\n      Some((label,vector))\n    }\n}\n\nimport org.apache.spark.mllib.clustering._   \ndef distance(a: Vector, b: Vector) = math.sqrt(a.toArray.zip(b.toArray).map(p => p._1 - p._2).map(d => d * d).sum)\ndef distToCentroid(datum: Vector, model: KMeansModel) = {\n  val cluster = model.predict(datum)\n  val centroid = model.clusterCenters(cluster)\n  distance(centroid, datum)\n}\n\nimport org.apache.spark.rdd._\nval dataAsArray = labelsAndData.values.map(_.toArray).cache()\nval numCols = dataAsArray.first().length\nval n = dataAsArray.count()\nval sums = dataAsArray.reduce(\n  (a,b) => a.zip(b).map(t => t._1 + t._2))\nval sumSquares = dataAsArray.fold(\n  new Array[Double](numCols))(\n  (a,b) => a.zip(b).map(t => t._1 + t._2 * t._2))\nval stdevs = sumSquares.zip(sums).map {\n  case(sumSq,sum) => math.sqrt(n*sumSq - sum*sum)/n\n}\nval means = sums.map(_ / n)\ndef normalize(datum: Vector) = {\n  val normalizedArray = (datum.toArray, means, stdevs).zipped.map(\n   (value, mean, stdev) =>\n     if (stdev <= 0) (value - mean) else (value - mean) / stdev\n  )\n  Vectors.dense(normalizedArray)\n}\n\nval normalizedLabelsAndData = labelsAndData.map(ld => (ld._1, normalize(ld._2))).cache()\n\ndef entropy(counts: Iterable[Int]) = {\n  val values = counts.filter(_ > 0)\n  val n: Double = values.sum\n  values.map { v =>\n        val p=v/n\n        -p * math.log(p)\n      }.sum\n}\n\nval kmeansNumberRuns = 10\nval kmeansEpsilon = 1.0e-6\ndef clusteringScore(normalizedLabelsAndData: RDD[(String,Vector)], k: Int) = {\n  val kmeans = new KMeans()\n  kmeans.setRuns(kmeansNumberRuns)\n  // The algorithm exposes setRuns() to set the number of times the clustering is run for one k.\n  // It can also be improved by running the iteration longer. The algorithm has a threshold via setEpsilon() which controls the minimum amount of cluster centroid movement that is considered significant; lower values means the K-means algorithm will let the centroids continue to move longer.\n  kmeans.setEpsilon(kmeansEpsilon)\n  kmeans.setK(k)\n  val model = kmeans.run(normalizedLabelsAndData.values)\n  val labelsAndClusters = normalizedLabelsAndData.mapValues(model.predict)\n  val clustersAndLabels = labelsAndClusters.map(_.swap)\n  val labelsInCluster = clustersAndLabels.groupByKey().values\n  val labelCounts = labelsInCluster.map( _.groupBy(l => l).map(_._2.size))\n  val n = normalizedLabelsAndData.count()\n  labelCounts.map(m => m.sum * entropy(m)).sum / n\n}\n\nval kAndScore = (10 to 60 by 10).par.map(k =>\n  (k, clusteringScore(normalizedLabelsAndData, k))).toList\nkAndScore.foreach(println)\n\ncase class kmeansScore(k: Int, score: Double)\nimport sqlContext.implicits._\nsc.parallelize(kAndScore).map{ case(a, b) => kmeansScore(a, b) }.toDF.registerTempTable(\"kscore\")","user":"songwenxin","dateUpdated":"2018-08-16T04:10:04+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one deprecation warning; re-run with -deprecation for details\n(smurf.,28150)\n(neptune.,10721)\n(normal.,9837)\n(back.,216)\n(satan.,168)\n(ipsweep.,125)\n(portsweep.,120)\n(teardrop.,100)\n(warezclient.,82)\n(nmap.,26)\n(pod.,25)\n(guess_passwd.,6)\n(land.,4)\n(buffer_overflow.,3)\n(imap.,2)\n(phf.,2)\n(warezmaster.,2)\n(rootkit.,1)\n(spy.,1)\n(label,1)\n(multihop.,1)\n(loadmodule.,1)\n(10,1.039246410290834)\n(20,0.489859498267558)\n(30,0.16510358200848269)\n(40,0.15472270351847714)\n(50,0.1478376587837916)\n(60,0.1435958863688825)\nrawData: org.apache.spark.rdd.RDD[String] = ./datasets/kddcupsmall MapPartitionsRDD[390] at textFile at <console>:35\nimport org.apache.spark.mllib.linalg._\nlabelsAndData: org.apache.spark.rdd.RDD[(String, org.apache.spark.mllib.linalg.Vector)] = MapPartitionsRDD[396] at flatMap at <console>:39\nimport org.apache.spark.mllib.clustering._\ndistance: (a: org.apache.spark.mllib.linalg.Vector, b: org.apache.spark.mllib.linalg.Vector)Double\ndistToCentroid: (datum: org.apache.spark.mllib.linalg.Vector, model: org.apache.spark.mllib.clustering.KMeansModel)Double\nimport org.apache.spark.rdd._\ndataAsArray: org.apache.spark.rdd.RDD[Array[Double]] = MapPartitionsRDD[398] at map at <console>:61\nnumCols: Int = 38\nn: Long = 49593\nsums: Array[Double] = Array(2596905.0, 7.44679891E8, 4.2060517E7, 4.0, 323..."}]},"apps":[],"jobName":"paragraph_1534392604223_-947217566","id":"20180802-131925_483985012","dateCreated":"2018-08-16T04:10:04+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3683"},{"title":"第五步：选取一个得分较低并且K值比较合理的K（K=40）","text":"%sql select * from kscore","user":"songwenxin","dateUpdated":"2018-08-16T04:10:04+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"k":"string","score":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"k","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"score","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"k\tscore\n10\t1.039246410290834\n20\t0.489859498267558\n30\t0.16510358200848269\n40\t0.15472270351847714\n50\t0.1478376587837916\n60\t0.1435958863688825\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1534392604223_1252986054","id":"20180802-132112_1300546034","dateCreated":"2018-08-16T04:10:04+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3684"},{"title":"第六步：用K=40再运行一次K-means算法，并打印出统计结果（聚类编号，网络访问类型，个数）","text":"%spark\nimport org.apache.spark.mllib.clustering._   \nval kmeans = new KMeans()\nkmeans.setRuns(kmeansNumberRuns)\nkmeans.setEpsilon(kmeansEpsilon)\nkmeans.setK(40)\nval model = kmeans.run(normalizedLabelsAndData.values)\n\nval clusterLabel = normalizedLabelsAndData.map {\n  case (label, data) =>\n    val cluster = model.predict(data)\n    (cluster, label)\n}\nclusterLabel.countByValue.toSeq.sorted.foreach {\n  case ((cluster,label),count) =>\n        println(f\"$cluster%1s$label%18s$count%8s\")\n}\ncase class clusterLabelType(cluster: Int, label: String)\nimport sqlContext.implicits._\nclusterLabel.map {\n  case (cluster, label) => clusterLabelType(cluster, label)\n}.toDF.registerTempTable(\"clusterLabel\")\n","user":"songwenxin","dateUpdated":"2018-08-16T04:10:30+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one deprecation warning; re-run with -deprecation for details\n0          neptune.    2010\n0           normal.      61\n0        portsweep.      14\n1             land.       4\n2           normal.       1\n3           normal.       4\n4           normal.       1\n5     guess_passwd.       6\n6              phf.       2\n7           normal.       3\n8          ipsweep.       2\n8           normal.       4\n8      warezclient.       1\n9             back.     170\n9           normal.    2109\n9      warezclient.       2\n10           normal.       1\n11           normal.       1\n12           normal.      48\n13          ipsweep.       2\n13             nmap.       5\n13           normal.    1281\n13              pod.       5\n13        portsweep.       1\n13          rootkit.       1\n13            satan.       2\n13            smurf.   28150\n13              spy.       1\n13         teardrop.       1\n13      warezmaster.       2\n14           normal.     138\n15          ipsweep.       1\n15           normal.      37\n15            satan.       1\n15      warezclient.       5\n16          neptune.       2\n16           normal.    1337\n16      warezclient.       4\n17          neptune.      13\n17           normal.     197\n17        portsweep.       9\n17            satan.       4\n18          ipsweep.      23\n18           normal.       4\n19              pod.      15\n20          neptune.    8640\n20           normal.       4\n20            satan.       5\n21         teardrop.      99\n22             back.      13\n22          ipsweep.       1\n22          neptune.       1\n22           normal.     621\n23             back.      32\n23             imap.       2\n23           normal.     576\n24           normal.     193\n25           normal.      10\n25      warezclient.      35\n26          ipsweep.       6\n26             nmap.      11\n26           normal.     477\n26              pod.       1\n26        portsweep.      75\n26            satan.       3\n27             back.       1\n27          neptune.      51\n27           normal.      51\n27        portsweep.       5\n27            satan.       1\n28       loadmodule.       1\n28           normal.       1\n29  buffer_overflow.       1\n29           normal.       1\n30           normal.     119\n31          neptune.       2\n31           normal.      60\n31              pod.       3\n31      warezclient.      20\n32          ipsweep.       5\n32             nmap.      10\n32           normal.     115\n32      warezclient.       6\n33           normal.       7\n33        portsweep.      16\n33            satan.     152\n34          ipsweep.      85\n34          neptune.       1\n34           normal.       5\n34      warezclient.       1\n35         multihop.       1\n35           normal.      24\n35      warezclient.       1\n36           normal.     372\n36              pod.       1\n37  buffer_overflow.       1\n37           normal.      22\n38  buffer_overflow.       1\n38          neptune.       1\n38           normal.    1608\n39           normal.     344\n39      warezclient.       7\nimport org.apache.spark.mllib.clustering._\nkmeans: org.apache.spark.mllib.clustering.KMeans = org.apache.spark.mllib.clustering.KMeans@776f4109\nmodel: org.apache.spark.mllib.clustering.KMeansModel = org.apache.spark.mllib.clustering.KMeansModel@2f4b2def\nclusterLabel: org.apache.spark.rdd.RDD[(Int, String)] = MapPartitionsRDD[891] at map at <console>:42\ndefined class clusterLabelType\nimport sqlContext.implicits._\n"}]},"apps":[],"jobName":"paragraph_1534392604223_-200220657","id":"20180802-132220_421137661","dateCreated":"2018-08-16T04:10:04+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3685"},{"title":"第七步：用可视化的方式显示K=40的时候，聚类的特征情况，比如第13号聚类，smurf网络访问类型非常多","text":"%sql select cluster, count(label) as count, label from clusterLabel group by cluster, label","user":"songwenxin","dateUpdated":"2018-08-16T04:10:42+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"cluster":"string","count":"string","label":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"pieChart":{}},"commonSetting":{},"keys":[{"name":"cluster","index":0,"aggr":"sum"},{"name":"label","index":2,"aggr":"sum"}],"groups":[],"values":[{"name":"count","index":1,"aggr":"max"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"cluster\tcount\tlabel\n26\t11\tnmap.\n16\t4\twarezclient.\n33\t16\tportsweep.\n26\t1\tpod.\n32\t6\twarezclient.\n17\t9\tportsweep.\n21\t99\tteardrop.\n17\t4\tsatan.\n13\t1\tspy.\n23\t32\tback.\n27\t51\tneptune.\n31\t2\tneptune.\n39\t344\tnormal.\n38\t1\tbuffer_overflow.\n17\t13\tneptune.\n13\t1281\tnormal.\n2\t1\tnormal.\n31\t20\twarezclient.\n23\t2\timap.\n36\t372\tnormal.\n34\t5\tnormal.\n17\t197\tnormal.\n13\t28150\tsmurf.\n22\t1\tneptune.\n33\t7\tnormal.\n0\t2010\tneptune.\n20\t4\tnormal.\n31\t60\tnormal.\n34\t1\tneptune.\n25\t35\twarezclient.\n31\t3\tpod.\n15\t37\tnormal.\n32\t5\tipsweep.\n27\t1\tback.\n8\t4\tnormal.\n9\t2109\tnormal.\n32\t115\tnormal.\n18\t4\tnormal.\n28\t1\tnormal.\n35\t1\tmultihop.\n13\t2\tipsweep.\n0\t61\tnormal.\n26\t477\tnormal.\n20\t5\tsatan.\n33\t152\tsatan.\n27\t5\tportsweep.\n26\t6\tipsweep.\n26\t75\tportsweep.\n3\t4\tnormal.\n23\t576\tnormal.\n11\t1\tnormal.\n36\t1\tpod.\n29\t1\tbuffer_overflow.\n18\t23\tipsweep.\n39\t7\twarezclient.\n27\t51\tnormal.\n13\t1\tportsweep.\n13\t1\tteardrop.\n25\t10\tnormal.\n7\t3\tnormal.\n15\t1\tipsweep.\n35\t24\tnormal.\n6\t2\tphf.\n22\t13\tback.\n24\t193\tnormal.\n22\t621\tnormal.\n5\t6\tguess_passwd.\n26\t3\tsatan.\n14\t138\tnormal.\n13\t1\trootkit.\n9\t2\twarezclient.\n4\t1\tnormal.\n9\t170\tback.\n30\t119\tnormal.\n15\t5\twarezclient.\n16\t1337\tnormal.\n27\t1\tsatan.\n8\t1\twarezclient.\n38\t1\tneptune.\n37\t1\tbuffer_overflow.\n35\t1\twarezclient.\n20\t8640\tneptune.\n19\t15\tpod.\n13\t5\tpod.\n0\t14\tportsweep.\n8\t2\tipsweep.\n37\t22\tnormal.\n13\t2\twarezmaster.\n10\t1\tnormal.\n13\t2\tsatan.\n28\t1\tloadmodule.\n12\t48\tnormal.\n22\t1\tipsweep.\n29\t1\tnormal.\n34\t85\tipsweep.\n34\t1\twarezclient.\n13\t5\tnmap.\n32\t10\tnmap.\n15\t1\tsatan.\n38\t1608\tnormal.\n1\t4\tland.\n16\t2\tneptune.\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1534392604224_-1349266738","id":"20180802-172049_338867071","dateCreated":"2018-08-16T04:10:04+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3686"},{"title":"第八步：接下来寻找每个聚类里面的“坏的”访问，与聚类中心点距离排在100名以外的都是潜在的“坏的”网络访问","text":"val distances = normalizedLabelsAndData.map {\n      case (label, data) => distToCentroid(data, model)\n    }\nval threshold = distances.top(100).last\n\nval originalAndData = rawData.zipWithIndex.flatMap {\n  case (line,index) =>\n    if (index == 0) {\n      None\n    } else {\n      val buffer = line.split(',').toBuffer\n      buffer.remove(1, 3)\n      val label = buffer.remove(buffer.length-1)\n      val vector = Vectors.dense(buffer.map(_.toDouble).toArray)\n      Some((line,vector))\n    }\n}\n\nval anomalies = originalAndData.filter {\n  case (original, data) =>\n    val normalized = normalize(data)\n    distToCentroid(normalized, model) > threshold\n}.keys\nanomalies.toDF.registerTempTable(\"anomalies\")\n","user":"songwenxin","dateUpdated":"2018-08-16T04:10:50+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one deprecation warning; re-run with -deprecation for details\ndistances: org.apache.spark.rdd.RDD[Double] = MapPartitionsRDD[904] at map at <console>:80\nthreshold: Double = 0.21009724828818901\noriginalAndData: org.apache.spark.rdd.RDD[(String, org.apache.spark.mllib.linalg.Vector)] = MapPartitionsRDD[907] at flatMap at <console>:85\nanomalies: org.apache.spark.rdd.RDD[String] = MapPartitionsRDD[909] at keys at <console>:102\n"}]},"apps":[],"jobName":"paragraph_1534392604224_-697964136","id":"20180802-172638_1337124142","dateCreated":"2018-08-16T04:10:04+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3687"},{"title":"第九步：以列表方式显示所有潜在的异常网络访问","text":"%sql select * from anomalies","user":"songwenxin","dateUpdated":"2018-08-16T04:10:59+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"value":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"entires","index":0,"aggr":"sum"}],"groups":[],"values":[]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"value\n257,tcp,telnet,SF,181,1222,0,0,0,0,0,1,0,0,0,0,2,0,0,0,0,0,1,1,0.00,0.00,0.00,0.00,1.00,0.00,0.00,62,15,0.21,0.05,0.02,0.13,0.03,0.13,0.00,0.00,normal.\n0,tcp,smtp,SF,1500,327,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,2,3,0.00,0.00,0.00,0.00,0.50,1.00,1.00,85,186,0.74,0.05,0.01,0.01,0.00,0.00,0.00,0.00,normal.\n0,tcp,auth,SF,10,38,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,2,1,0.00,0.00,0.00,0.00,0.50,1.00,0.00,42,14,0.05,0.10,0.02,0.14,0.00,0.00,0.00,0.00,normal.\n0,tcp,auth,SF,10,36,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,2,1,0.00,0.00,0.00,0.00,0.50,1.00,0.00,57,14,0.05,0.07,0.02,0.14,0.00,0.00,0.00,0.00,normal.\n0,tcp,finger,SF,6,147,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0.00,0.00,0.00,0.00,1.00,0.00,0.00,29,7,0.03,0.10,0.03,0.43,0.03,0.00,0.00,0.00,normal.\n0,icmp,ecr_i,SF,1480,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16,16,0.00,0.00,0.00,0.00,1.00,0.00,0.00,100,16,0.16,0.04,0.16,0.00,0.00,0.00,0.00,0.00,pod.\n0,icmp,ecr_i,SF,1480,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,20,20,0.00,0.00,0.00,0.00,1.00,0.00,0.00,104,20,0.19,0.04,0.19,0.00,0.00,0.00,0.00,0.00,pod.\n0,tcp,auth,SF,10,39,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,2,1,0.00,0.00,0.00,0.00,0.50,1.00,0.00,98,17,0.08,0.04,0.01,0.12,0.00,0.00,0.00,0.00,normal.\n0,tcp,private,REJ,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0.00,0.00,1.00,1.00,1.00,0.00,0.00,66,2,0.02,1.00,0.02,1.00,0.00,0.00,0.92,1.00,ipsweep.\n0,tcp,private,REJ,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0.00,0.00,1.00,1.00,1.00,0.00,0.00,30,2,0.03,1.00,0.03,1.00,0.00,0.00,0.90,1.00,ipsweep.\n0,udp,domain_u,SF,45,110,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,0.00,0.00,0.00,0.00,0.50,1.00,1.00,255,240,0.94,0.01,0.00,0.00,0.00,0.00,0.00,0.00,normal.\n0,tcp,finger,S0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1.00,1.00,0.00,0.00,1.00,0.00,0.00,1,8,1.00,0.00,1.00,0.38,1.00,0.12,0.00,0.00,land.\n0,tcp,pop_3,SF,38,130,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,1,0.00,0.00,0.00,0.00,1.00,0.00,0.00,25,5,0.12,0.20,0.04,0.40,0.00,0.00,0.00,0.00,normal.\n0,tcp,http,REJ,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,0.00,0.00,1.00,1.00,1.00,0.00,1.00,1,85,1.00,0.00,1.00,0.29,0.00,0.00,1.00,1.00,normal.\n4,tcp,smtp,SF,1959,331,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,2,3,0.00,0.00,0.00,0.00,0.50,1.00,1.00,32,156,0.59,0.12,0.03,0.01,0.00,0.00,0.00,0.00,normal.\n179,tcp,ftp,SF,87,319,0,0,0,1,0,1,0,0,0,0,1,0,0,0,0,1,1,1,0.00,0.00,0.00,0.00,1.00,0.00,0.00,255,2,0.01,0.01,0.00,0.00,0.00,0.00,0.04,0.00,multihop.\n1,tcp,smtp,SF,1155,332,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,2,2,0.00,0.00,0.00,0.00,0.50,1.00,1.00,103,164,0.73,0.04,0.01,0.01,0.00,0.00,0.00,0.00,normal.\n0,tcp,ftp_data,SF,7940,0,0,0,0,0,0,1,0,0,0,0,2,0,0,0,0,0,8,8,0.00,0.00,0.00,0.00,1.00,0.00,0.00,136,52,0.21,0.10,0.27,0.04,0.01,0.02,0.02,0.00,normal.\n0,tcp,smtp,SF,1210,329,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,2,2,0.00,0.00,0.00,0.00,0.50,1.00,1.00,255,89,0.35,0.03,0.00,0.00,0.00,0.00,0.00,0.00,normal.\n0,icmp,eco_i,SF,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,0.00,0.00,0.00,0.00,1.00,0.00,1.00,2,110,1.00,0.00,1.00,0.25,0.00,0.00,0.00,0.00,nmap.\n0,icmp,eco_i,SF,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,21,0.00,0.00,0.00,0.00,1.00,0.00,1.00,2,190,1.00,0.00,1.00,0.25,0.00,0.00,0.00,0.00,nmap.\n0,icmp,eco_i,SF,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,28,0.00,0.00,0.00,0.00,1.00,0.00,1.00,2,61,1.00,0.00,1.00,0.26,0.00,0.00,0.00,0.00,nmap.\n0,icmp,eco_i,SF,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,10,0.00,0.00,0.00,0.00,1.00,0.00,1.00,4,68,1.00,0.00,1.00,0.25,0.00,0.00,0.00,0.00,nmap.\n0,icmp,eco_i,SF,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,30,0.00,0.00,0.00,0.00,1.00,0.00,1.00,2,98,1.00,0.00,1.00,0.26,0.00,0.00,0.00,0.00,nmap.\n0,icmp,eco_i,SF,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,49,0.00,0.00,0.00,0.00,1.00,0.00,1.00,4,20,1.00,0.00,1.00,0.25,0.00,0.00,0.00,0.00,nmap.\n0,icmp,eco_i,SF,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,6,0.00,0.00,0.00,0.00,1.00,0.00,1.00,1,255,1.00,0.00,1.00,0.25,0.00,0.00,0.00,0.00,nmap.\n0,icmp,eco_i,SF,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,50,0.00,0.00,0.00,0.00,1.00,0.00,1.00,1,89,1.00,0.00,1.00,0.26,0.00,0.00,0.00,0.00,nmap.\n0,icmp,eco_i,SF,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,5,0.00,0.00,0.00,0.00,1.00,0.00,1.00,1,209,1.00,0.00,1.00,0.25,0.00,0.00,0.00,0.00,nmap.\n0,tcp,finger,S0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1.00,1.00,0.00,0.00,1.00,0.00,0.00,1,6,1.00,0.00,1.00,0.33,1.00,0.17,0.00,0.00,land.\n0,tcp,finger,S0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,1.00,1.00,0.00,0.00,1.00,0.00,1.00,1,3,1.00,0.00,1.00,1.00,1.00,1.00,0.00,0.00,land.\n7,tcp,smtp,SF,1112,331,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,2,3,0.00,0.00,0.00,0.00,0.50,1.00,1.00,255,152,0.60,0.03,0.00,0.00,0.00,0.00,0.00,0.00,normal.\n0,tcp,auth,SF,9,35,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,1,0.00,0.00,0.00,0.00,0.50,1.00,0.00,11,5,0.09,0.36,0.09,0.40,0.00,0.00,0.00,0.00,normal.\n0,tcp,finger,S0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,1.00,1.00,0.00,0.00,1.00,0.00,1.00,1,6,1.00,0.00,1.00,0.33,1.00,0.17,0.00,0.00,land.\n0,tcp,smtp,SF,633,329,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,2,2,0.00,0.00,0.00,0.00,0.50,1.00,1.00,132,82,0.37,0.04,0.01,0.02,0.01,0.01,0.00,0.00,normal.\n0,tcp,uucp,REJ,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,1,0.00,0.00,0.33,1.00,0.33,1.00,0.00,255,1,0.00,0.04,0.00,0.00,0.00,0.00,0.00,1.00,satan.\n0,tcp,auth,SF,10,35,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,2,1,0.00,0.00,0.00,0.00,0.50,1.00,0.00,138,9,0.05,0.05,0.01,0.22,0.00,0.00,0.00,0.00,normal.\n0,tcp,smtp,SF,827,327,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,2,2,0.00,0.00,0.00,0.00,0.50,1.00,1.00,147,116,0.79,0.04,0.01,0.00,0.01,0.01,0.00,0.00,normal.\n2,tcp,smtp,SF,3312,332,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,2,4,0.00,0.00,0.00,0.00,0.50,1.00,1.00,183,110,0.44,0.03,0.01,0.02,0.01,0.02,0.01,0.01,normal.\n0,tcp,auth,SF,10,35,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,1,0.00,0.00,0.00,0.00,0.50,1.00,0.00,96,7,0.04,0.05,0.01,0.29,0.00,0.00,0.00,0.00,normal.\n0,udp,domain_u,SF,29,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,14,0.00,0.00,0.00,0.00,0.50,1.00,0.36,131,31,0.10,0.05,0.10,0.06,0.00,0.00,0.00,0.00,normal.\n0,udp,domain_u,SF,33,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,0.00,0.00,0.00,0.00,0.50,1.00,1.00,18,2,0.11,0.22,0.11,0.00,0.00,0.00,0.00,0.00,normal.\n0,tcp,ftp_data,SF,334,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,1,0.00,0.00,0.00,0.00,1.00,0.00,0.00,1,5,1.00,0.00,1.00,0.40,0.00,0.00,0.00,0.00,warezclient.\n0,tcp,telnet,S0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16,3,1.00,1.00,0.00,0.00,0.19,0.12,0.00,43,4,0.07,0.07,0.02,0.50,1.00,0.75,0.00,0.00,neptune.\n0,udp,private,SF,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,3,0.00,0.00,0.00,0.00,0.50,0.33,0.00,255,3,0.01,0.98,0.02,0.00,0.20,0.00,0.78,0.00,satan.\n0,tcp,other,SF,16787,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,10,1,0.10,0.00,0.00,0.00,0.10,0.80,0.00,82,1,0.01,0.12,0.27,0.00,0.02,0.00,0.00,0.00,normal.\n1,tcp,smtp,SF,2301,334,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,2,5,0.00,0.00,0.00,0.00,0.50,1.00,1.00,255,117,0.46,0.08,0.00,0.00,0.02,0.02,0.00,0.00,normal.\n1,tcp,smtp,SF,1554,334,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,2,2,0.00,0.00,0.00,0.00,0.50,1.00,1.00,152,153,0.74,0.04,0.01,0.01,0.00,0.00,0.00,0.00,normal.\n0,tcp,http,REJ,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,4,0.00,0.00,1.00,1.00,1.00,0.00,1.00,5,36,1.00,0.00,0.20,0.31,0.00,0.00,1.00,1.00,normal.\n2,tcp,private,RSTR,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,425,2,0.00,0.00,1.00,1.00,0.00,0.52,0.00,255,2,0.01,0.51,1.00,0.00,0.00,0.00,1.00,1.00,portsweep.\n1,tcp,private,RSTR,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,220,2,0.00,0.00,1.00,1.00,0.01,0.50,0.00,255,2,0.01,0.51,1.00,0.00,0.00,0.00,1.00,1.00,portsweep.\n1,tcp,private,RSTR,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,250,2,0.00,0.00,1.00,1.00,0.01,0.50,0.00,255,2,0.01,0.51,1.00,0.00,0.00,0.00,1.00,1.00,portsweep.\n1,tcp,private,RSTR,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,260,2,0.00,0.00,1.00,1.00,0.01,0.50,0.00,255,2,0.01,0.50,1.00,0.00,0.00,0.00,1.00,1.00,portsweep.\n1,tcp,private,RSTR,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,270,2,0.00,0.00,1.00,1.00,0.01,0.50,0.00,255,2,0.01,0.50,1.00,0.00,0.00,0.00,1.00,1.00,portsweep.\n0,tcp,private,REJ,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,320,1,0.00,0.00,1.00,1.00,0.00,0.51,0.00,255,1,0.00,0.51,1.00,0.00,0.00,0.00,1.00,1.00,portsweep.\n0,tcp,smtp,SF,711,330,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,2,0.00,0.00,0.00,0.00,1.00,0.00,1.00,255,3,0.01,0.87,0.00,0.00,0.00,0.00,0.00,0.00,normal.\n0,tcp,ftp_data,SF,334,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,1,0.00,0.00,0.00,0.00,1.00,0.00,0.00,1,5,1.00,0.00,1.00,0.40,0.00,0.00,0.00,0.00,warezclient.\n0,tcp,ftp_data,SF,334,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,1,0.00,0.00,0.00,0.00,1.00,0.00,0.00,1,9,1.00,0.00,1.00,0.44,0.00,0.00,0.00,0.00,warezclient.\n0,tcp,http,REJ,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,0.00,0.00,1.00,1.00,1.00,0.00,1.00,2,118,1.00,0.00,0.50,0.35,0.00,0.01,1.00,0.99,normal.\n0,tcp,auth,SF,14,39,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,1,0.00,0.00,0.00,0.00,1.00,0.00,0.00,2,2,0.50,1.00,0.50,1.00,0.00,0.00,0.00,0.00,normal.\n0,tcp,private,REJ,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,1,0.00,0.00,1.00,1.00,0.50,1.00,0.00,255,1,0.00,0.13,0.11,0.00,0.00,0.00,0.11,1.00,portsweep.\n1,tcp,smtp,SF,2748,455,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,3,0.00,0.00,0.00,0.00,1.00,0.00,1.00,13,12,0.85,0.23,0.08,0.17,0.00,0.00,0.00,0.08,normal.\n0,icmp,ecr_i,SF,1480,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0.00,0.00,0.00,0.00,1.00,0.00,0.00,2,1,0.50,1.00,0.50,0.00,0.00,0.00,0.00,0.00,pod.\n0,icmp,ecr_i,SF,1480,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,4,0.00,0.00,0.00,0.00,1.00,0.00,0.50,3,10,0.67,0.67,0.67,0.50,0.00,0.00,0.00,0.00,pod.\n0,tcp,smtp,SF,1692,330,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,2,2,0.00,0.00,0.00,0.00,0.50,1.00,1.00,168,107,0.57,0.04,0.01,0.02,0.01,0.00,0.01,0.00,normal.\n0,tcp,finger,SF,7,136,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,1,0.00,0.00,0.00,0.00,0.33,0.67,0.00,209,6,0.02,0.03,0.00,0.33,0.00,0.00,0.00,0.00,normal.\n1,tcp,smtp,SF,973,330,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,2,4,0.00,0.00,0.00,0.00,0.50,1.00,1.00,58,142,0.53,0.09,0.02,0.01,0.00,0.00,0.00,0.00,normal.\n0,udp,private,SF,28,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0.00,0.00,0.00,0.00,1.00,0.00,0.00,255,1,0.00,0.02,0.00,0.00,0.00,0.00,0.77,0.00,teardrop.\n2427,udp,other,SF,146,105,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,2,0.00,0.00,0.00,0.00,0.50,0.50,0.00,255,2,0.01,0.87,0.99,0.00,0.00,0.00,0.00,0.00,normal.\n0,udp,domain_u,SF,33,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,0.00,0.00,0.00,0.00,1.00,0.00,1.00,255,1,0.00,0.85,0.00,0.00,0.00,0.00,0.00,0.00,normal.\n0,udp,private,SF,28,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,106,6,0.94,0.00,0.00,0.00,0.06,0.07,0.00,255,6,0.02,0.98,0.02,0.00,0.09,0.00,0.89,0.00,teardrop.\n0,udp,private,SF,28,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,112,12,0.89,0.00,0.00,0.00,0.11,0.06,0.00,255,12,0.05,0.96,0.05,0.00,0.09,0.00,0.87,0.00,teardrop.\n0,udp,private,SF,28,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,117,17,0.85,0.00,0.00,0.00,0.15,0.06,0.00,255,17,0.07,0.94,0.07,0.00,0.09,0.00,0.85,0.00,teardrop.\n0,udp,private,SF,28,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,124,24,0.81,0.00,0.00,0.00,0.19,0.06,0.00,255,24,0.09,0.91,0.09,0.00,0.09,0.00,0.82,0.00,teardrop.\n0,udp,private,SF,28,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,139,39,0.72,0.00,0.00,0.00,0.28,0.05,0.00,255,39,0.15,0.85,0.15,0.00,0.09,0.00,0.76,0.00,teardrop.\n0,udp,private,SF,28,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,140,40,0.71,0.00,0.00,0.00,0.29,0.05,0.00,255,40,0.16,0.85,0.16,0.00,0.09,0.00,0.76,0.00,teardrop.\n0,icmp,ecr_i,SF,1480,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,4,0.00,0.00,0.00,0.00,1.00,0.00,0.50,4,151,1.00,0.00,1.00,0.06,0.00,0.00,0.00,0.00,pod.\n0,icmp,ecr_i,SF,1480,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,4,0.00,0.00,0.00,0.00,1.00,0.00,0.50,2,151,1.00,0.00,1.00,0.11,0.00,0.00,0.00,0.00,pod.\n0,icmp,ecr_i,SF,1480,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,4,0.00,0.00,0.00,0.00,1.00,0.00,0.50,4,151,1.00,0.00,1.00,0.12,0.00,0.00,0.00,0.00,pod.\n0,icmp,ecr_i,SF,1480,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,3,0.00,0.00,0.00,0.00,1.00,0.00,0.67,1,151,1.00,0.00,1.00,0.13,0.00,0.00,0.00,0.00,pod.\n0,tcp,http,REJ,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,0.00,0.00,1.00,1.00,1.00,0.00,1.00,3,22,1.00,0.00,0.33,0.36,0.00,0.00,1.00,1.00,normal.\n2625,udp,other,SF,145,105,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,2,0.00,0.00,0.00,0.00,0.50,0.50,0.00,255,2,0.01,0.84,1.00,0.00,0.00,0.00,0.00,0.00,normal.\n0,tcp,smtp,SF,2206,331,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,1,2,0.00,0.00,0.00,0.00,1.00,0.00,1.00,255,7,0.03,0.65,0.00,0.00,0.00,0.00,0.00,0.00,normal.\n4610,udp,other,SF,146,105,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,2,0.00,0.00,0.00,0.00,0.50,0.50,0.00,255,2,0.01,0.82,1.00,0.00,0.00,0.00,0.00,0.00,normal.\n15610,udp,other,SF,146,105,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,2,0.00,0.00,0.00,0.00,0.50,0.50,0.00,255,2,0.01,0.84,1.00,0.00,0.00,0.00,0.00,0.00,normal.\n2625,udp,other,SF,146,105,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,2,0.00,0.00,0.00,0.00,0.50,0.50,0.00,255,2,0.01,0.86,1.00,0.00,0.00,0.00,0.00,0.00,normal.\n2625,udp,other,SF,146,105,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,2,0.00,0.00,0.00,0.00,0.50,0.50,0.00,255,2,0.01,0.86,0.99,0.00,0.00,0.00,0.00,0.00,normal.\n0,icmp,ecr_i,SF,1480,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12,12,0.00,0.00,0.00,0.00,1.00,0.00,0.00,255,14,0.05,0.02,0.05,0.00,0.00,0.00,0.00,0.00,pod.\n0,icmp,ecr_i,SF,1480,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,15,0.00,0.00,0.00,0.00,1.00,0.00,0.00,255,17,0.07,0.02,0.07,0.00,0.00,0.00,0.00,0.00,pod.\n0,icmp,ecr_i,SF,1480,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,20,20,0.00,0.00,0.00,0.00,1.00,0.00,0.00,255,22,0.09,0.02,0.09,0.00,0.00,0.00,0.00,0.00,pod.\n23815,udp,other,SF,147,105,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,2,0.00,0.00,0.00,0.00,0.50,0.50,0.00,255,2,0.01,0.84,0.99,0.00,0.00,0.00,0.00,0.00,normal.\n21180,udp,other,SF,147,105,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,2,0.00,0.00,0.00,0.00,0.50,0.50,0.00,255,2,0.01,0.83,1.00,0.00,0.00,0.00,0.00,0.00,normal.\n5600,udp,other,SF,147,105,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,2,0.00,0.00,0.00,0.00,0.50,0.50,0.00,255,2,0.01,0.84,1.00,0.00,0.00,0.00,0.00,0.00,normal.\n5605,udp,other,SF,147,105,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,2,0.00,0.00,0.00,0.00,0.50,0.50,0.00,255,2,0.01,0.84,1.00,0.00,0.00,0.00,0.00,0.00,normal.\n0,tcp,smtp,SF,613,328,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,2,3,0.00,0.00,0.00,0.00,0.50,1.00,1.00,255,17,0.07,0.62,0.00,0.00,0.00,0.00,0.00,0.00,normal.\n0,tcp,http,REJ,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0.00,0.00,1.00,1.00,1.00,0.00,0.00,1,7,1.00,0.00,1.00,0.43,0.00,0.00,1.00,1.00,normal.\n2710,udp,other,SF,147,105,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,2,0.00,0.00,0.00,0.00,0.50,0.50,0.00,255,2,0.01,0.84,1.00,0.00,0.00,0.00,0.00,0.00,normal.\n1,tcp,smtp,SF,1233,330,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,3,0.00,0.00,0.00,0.00,1.00,0.00,1.00,3,201,0.67,0.67,0.33,0.01,0.00,0.01,0.00,0.00,normal.\n0,icmp,eco_i,SF,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,0.00,0.00,0.00,0.00,1.00,0.00,1.00,4,43,1.00,0.00,1.00,0.26,0.00,0.00,0.00,0.00,ipsweep.\n0,tcp,smtp,SF,3545,329,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,2,0.00,0.00,0.00,0.00,1.00,0.00,1.00,255,14,0.05,0.70,0.00,0.00,0.00,0.00,0.00,0.00,normal.\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1534392604224_1085262767","id":"20180802-172743_1000631367","dateCreated":"2018-08-16T04:10:04+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3688"}],"name":"K-means教程","id":"2DNVMPCSF","noteParams":{},"noteForms":{},"angularObjects":{},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}